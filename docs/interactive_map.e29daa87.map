{"version":3,"sources":["interactive_map.js"],"names":["_map","_centerLat","_centerLng","_dataFile","require","_accessToken","_mapStyle","init","addSource","type","data","addLayer","property","stops","popup","mapboxgl","Popup","closeButton","closeOnClick","on","e","getCanvas","style","cursor","coordinates","features","geometry","slice","properties","title","name_en","era","era_en","address","province_en","classification_en","Math","layout","abs","lngLat","lng","setLngLat","setHTML","addTo","remove","accessToken","Map","container","center","zoom","once","addControl","NavigationControl","layers","colors","i","length","layer","color","item","document","createElement","key","className","backgroundColor","value","innerHTML","appendChild","legend"],"mappings":";;;AAAA,IAAIA,EAAe,KACXC,EAAe,KACfC,EAAe,IAEfC,EAAeC,QAAQ,+CACvBC,EAAe,qEACfC,EAAe,qDAUnB,SAASC,IAEPP,EAAKQ,UAAW,iBAAkB,CACCC,KAAM,UACNC,KAAMP,IAGzCH,EAAKW,SACL,CACQ,GAAA,UACE,KAAA,SACE,OAAA,iBACD,MAAA,CAEC,eAAA,CACEC,SAAU,oBACVH,KAAM,cACNI,MAAO,CACH,CAAC,uBAAwB,WACzB,CAAC,gBAAiB,WAClB,CAAC,uCAAwC,WACzC,CAAC,eAAgB,WACjB,CAAC,gCAAiC,WAClC,CAAC,SAAU,aAGC,gBAAA,IACM,sBAAA,MAKtCC,IAAAA,EAAQ,IAAIC,SAASC,MAAM,CACvBC,aAAa,EACbC,cAAc,IAIjBlB,EAAKmB,GAAG,aAAc,UAAW,SAASC,GACvCpB,EAAKqB,YAAYC,MAAMC,OAAS,UAE5BC,IAAAA,EAAcJ,EAAEK,SAAS,GAAGC,SAASF,YAAYG,QACvCP,EAAEK,SAAS,GAEZL,EAAEK,SAAS,GAAGG,WAExBC,MAAQT,EAAEK,SAAS,GAAGG,WAAWE,QAEjCC,IAAMX,EAAEK,SAAS,GAAGG,WAAWI,OAC/BC,QAAUb,EAAEK,SAAS,GAAGG,WAAWM,YACnCzB,KAAOW,EAAEK,SAAS,GAAGG,WAAWO,kBAsB5BC,IApBHC,IAAAA,EAAS,+BAAiCR,MAAQ,0FAEeI,QAAU,mDACbxB,KAAO,kDACRsB,IAAM,qBAgBhEK,KAAKE,IAAIlB,EAAEmB,OAAOC,IAAMhB,EAAY,IAAM,KAC7CA,EAAY,IAAMJ,EAAEmB,OAAOC,IAAMhB,EAAY,GAAK,KAAO,IAI7DV,EAAM2B,UAAUjB,GAObkB,QAAQL,GACRM,MAAM3C,KAQXA,EAAKmB,GAAG,WAAY,UAAW,WAC7BnB,EAAKqB,YAAYC,MAAMC,OAAS,GAChCT,EAAM8B,WAvGV7B,SAAS8B,YAAcxC,GACvBL,EAAO,IAAIe,SAAS+B,IAAK,CACEC,UAAW,MACXzB,MAAOhB,EACP0C,OAAQ,CAAC9C,EAAYD,GACrBgD,KAAM,OAsG5BC,KAAM,aAAc,SAAU9B,GAEjCb,IACAP,EAAKmD,WAAY,IAAIpC,SAASqC,mBAG5BC,IAAAA,EAAS,CAAC,2BAA4B,QAAS,0BACtC,OAAQ,0BAA0B,UAC3CC,EAAS,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,WAEhEC,IAAAA,EAAI,EAAGA,EAAIF,EAAOG,OAAQD,IAAK,CAC9BE,IAAAA,EAAQJ,EAAOE,GACfG,EAAQJ,EAAOC,GACfI,EAAOC,SAASC,cAAc,OAC9BC,EAAMF,SAASC,cAAc,QACjCC,EAAIC,UAAY,aAChBD,EAAIxC,MAAM0C,gBAAkBN,EACxBO,IAAAA,EAAQL,SAASC,cAAc,QACnCI,EAAMC,UAAYT,EAClBE,EAAKQ,YAAYL,GACjBH,EAAKQ,YAAYF,GACjBG,OAAOD,YAAYR","file":"interactive_map.e29daa87.map","sourceRoot":"../src","sourcesContent":["var _map         = null,\n        _centerLat   = 35.5,\n        _centerLng   = 105,\n\n        _dataFile    = require('./data/architecture_point_completed.geojson'),\n        _accessToken = \"pk.eyJ1Ijoiemh1c2lydWkiLCJhIjoiczRLMGhEMCJ9.37GHQC_3mSKufR5ERmXsLw\",\n        _mapStyle    = \"mapbox://styles/zhusirui/cjote0r366qqd2spcea8df8td\";\n\n    mapboxgl.accessToken = _accessToken;\n    _map = new mapboxgl.Map ({\n                               container: \"map\",\n                               style: _mapStyle,\n                               center: [_centerLng, _centerLat],\n                               zoom: 3.3\n    });\n\n    function init ()\n    {\n      _map.addSource (\"markers-source\", {\n                                         type: \"geojson\",\n                                         data: _dataFile\n      });\n\n      _map.addLayer (\n      {\n        \"id\": \"markers\",\n        \"type\": \"circle\",\n        \"source\": \"markers-source\",\n        \"paint\": {\n                  \"circle-color\":\n                  {\n                    property: \"classification_en\",\n                    type: \"categorical\",\n                    stops: [\n                        ['Ancient architecture', \"#66c2a5\"], \n                        ['Ancient ruins', \"#fc8d62\"], \n                        ['Historical buildings of modern times', \"#8da0cb\"], \n                        ['Ancient tomb', \"#e78ac3\"], \n                        ['Cave temple and stone carving', \"#a6d854\"], \n                        ['others', \"#ffd92f\"] \n                    ]\n                    },\n                   \"circle-radius\": 3.5,\n                   \"circle-stroke-width\": 0.5\n                 }\n         });\n\n// change the click to hover    \nvar popup = new mapboxgl.Popup({\n        closeButton: false,\n        closeOnClick: false\n      });\n\n\n     _map.on('mouseenter', 'markers', function(e) {\n        _map.getCanvas().style.cursor = \"default\";\n\n        var coordinates = e.features[0].geometry.coordinates.slice();\n        var feature = e.features[0]\n        \n        var detail = e.features[0].properties\n        // console.log('Detail is', detail)\n           title = e.features[0].properties.name_en\n        // console.log('Title is', title)\n           era = e.features[0].properties.era_en\n           address = e.features[0].properties.province_en\n           type = e.features[0].properties.classification_en\n\n        var layout = \"<div class='g-popup-line-1'>\" + title + \"</div>\" + \n                     \"<div class='g-popup-divider'></div>\" +\n                     \"<div class='g-popup-line-1-address'>\" + 'Province: ' + address + \"</div>\" + \n                      \"<div class='g-popup-line-1-address'>\" + 'Type: ' + type + \"</div>\" + \n                      \"<div class='g-popup-line-1-address'>\" + 'Era: ' + era + \"</div>\" + \n                      \"</div></div>\"\n        //               \"<div class='g-popup-line-2' style='width: 50%;'>RESIDENTS PER:</div>\" + \n        //               \"<div class='g-popup-line-2' style='width: 25%; text-align: right;'>AIDE</div>\" + \n        //               \"<div class='g-popup-line-2' style='width: 25%; text-align: right;'>NURSE</div>\" +\n        //               \"<div class='g-popup-divider'></div>\" +\n        //               \"<div class='.g-popup-line-container'><div class='g-popup-line-3' style='width: 50%;'>Best days</div>\" + \n        //               \"<div class='g-popup-line-3' style='width: 25%; text-align: right; font-weight: 700;'>\" + bestDayAide + \"</div>\" + \n        //               \"<div class='g-popup-line-3' style='width: 25%; text-align: right; font-weight: 700;'>\" + bestDayNurse + \"</div></div>\" +\n        //               \"<div class='.g-popup-line-container'><div class='g-popup-line-3' style='width: 50%;'>Worst days</div>\" + \n        //               \"<div class='g-popup-line-3' style='width: 25%; text-align: right; font-weight: 700;'>\" + worstDayAide + \"</div>\" + \n        //               \"<div class='g-popup-line-3' style='width: 25%; text-align: right; font-weight: 700;'>\" + worstDayNurse + \"</div></div>\";\n\n\n\n\n        while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {\n            coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;\n        }\n        // .setLngLat(_map.unproject(e.point))\n        // console.log(feature)\n        popup.setLngLat(coordinates)\n          // .setHTML(\"<h4>Relics Information</h4>\" + \n          //                     \"<table>\" + \"<tr>\" + \n          //                     \"<th>Relics Classification\" + \"</th>\" + \"<th>Relics Era\" + \"</th>\" + \"<th>Relics Detail\" + \"</th>\" + \"</tr>\" + \"<tr>\" + \n          //                     \"<td>\" + feature.properties.classification_en + \"</td>\" + \"<td>\" + feature.properties.era_en + \"</td>\" + \"<td>\" + feature.properties.add_detail + \"</td>\" + \"</tr>\" + \n          //                     \"</table>\"\n          //                    )\n          .setHTML(layout)\n          .addTo(_map);\n\n            // _map.getSource(\"highlight\").setData({ \"type\":\"circle\",\n            //                                       \"coordinates\": coordinates\n            //                                       });\n            // _map.setLayoutProperty(\"highlight\", \"visibility\", \"visible\");\n      });\n\n      _map.on('mouseout', 'markers', function() {\n        _map.getCanvas().style.cursor = '';\n        popup.remove();\n    });\n    }\n\n    _map.once (\"style.load\", function (e)\n    {\n      init ();\n      _map.addControl (new mapboxgl.NavigationControl ());\n\n\n    var layers = ['Architecture before 1912', 'Ruins', 'Architecture after 1912',\n                 'Tomb', 'Cave temple and carving','Others'];\n    var colors = [\"#66c2a5\", \"#fc8d62\", \"#8da0cb\", \"#e78ac3\", \"#a6d854\", \"#ffd92f\"];\n\n    for (i = 0; i < layers.length; i++) {\n      var layer = layers[i];\n      var color = colors[i];\n      var item = document.createElement('div');\n      var key = document.createElement('span');\n      key.className = 'legend-key';\n      key.style.backgroundColor = color;\n      var value = document.createElement('span');\n      value.innerHTML = layer;\n      item.appendChild(key);\n      item.appendChild(value);\n      legend.appendChild(item);\n    }\n\n\n    });"]}